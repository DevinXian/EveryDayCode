<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="google" content="notranslate" />
<link rel="icon" href="/assets/icon.png" />
<title>Js 单体模式 - Every Day Code </title>
<link rel="stylesheet" href="/assets/acyort.css" />
</head>
<body>

<div class="header">
    <div class="center">
        <h1><a href="/">Every Day Code</a></h1>
        <p></p>
    </div>
    <div class="menu">
        <a href="/">home</a>
        <a href="/page/about/">about</a>
        <a href="/archives/">archives</a>
    </div>
</div>

<div id="post" class="center">

    <h1>Js 单体模式</h1>
    <p><a href="https://github.com/dyygtfx">dyygtfx</a> Updated at Feb 17, 2016</p>

    <div class="content"><p>第二次创建的对象与第一次完全相同，预期的结果如下
var a = new Test()
var b = new Test()
a === b; //结果为 true</p>
<p>实现方法：
1.通过静态属性</p>
<pre><code><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Test</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> Test.instance === <span class="hljs-string">"object"</span>) {
        <span class="hljs-keyword">return</span> Test.instance;
    }

    <span class="hljs-keyword">this</span>.start_img = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.bang = <span class="hljs-string">"Big"</span>

    Test.instance = <span class="hljs-keyword">this</span>;<span class="hljs-comment">//缓存</span>

    <span class="hljs-comment">// 隐式返回</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
}
<span class="hljs-keyword">var</span> a = <span class="hljs-keyword">new</span> Test();
<span class="hljs-keyword">var</span> b = <span class="hljs-keyword">new</span> Test();
a === b
</code></pre><p>2.通过闭包</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Test</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> instance = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">this</span>.start_img = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.bang = <span class="hljs-string">"Big"</span>

    Test = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> instance;
    }
}
<span class="hljs-keyword">var</span> a = <span class="hljs-keyword">new</span> Test();
<span class="hljs-keyword">var</span> b = <span class="hljs-keyword">new</span> Test();
a === b
</code></pre>
<p>这个闭包的方法有个缺点就是添加到 Ts=est() 的原型中的对象都不会存在指向由原始实现所创见实例的链接</p>
</div>

    <div class="label">
    <div><a href="/tags/原生 JS/">#原生 JS</a></div>
    </div>

    <div class="comment_list hide" id="disqus_thread"></div>
    <div id="duoshuo_thread" class="comment_list hide ds-thread" data-thread-key="53996195" data-title="" data-url=""></div>

    <button class="hide" data-id="53996195" id="comment">Add Comments</button>

</div>

<div class="footer">
    <div class="center">
        © 2016 Every Day Code . <a target="_blank" href="https://github.com/LoeiFy/AcyOrt">AcyOrt</a> . <a target="_blank" href="/rss.xml">RSS</a>
    </div>
</div>

<script>

if ('哥特复兴'.length > 0) {
    document.getElementById('comment').classList.remove('hide')
}

var duoshuoQuery = {short_name: '哥特复兴'};

document.getElementById('comment').addEventListener('click', function() {

    this.style.display = 'none';

    var identifier = this.getAttribute('data-id'),
        title = document.title,
        url = location.href.split('?')[0];

    document.getElementById('duoshuo_thread').setAttribute('data-title', title)
    document.getElementById('duoshuo_thread').setAttribute('data-url', url)

    var disqus_config = function () {
        this.page.url = url;
        this.page.identifier = identifier;
    };

    var sc = document.createElement('script'); 
    sc.async = true;
    sc.src = (location.protocol == 'https:' ? 'https:' : 'http:') + '//哥特复兴.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(sc);

    if ('//哥特复兴.disqus.com/embed.js'.indexOf('disqus') > -1) {
        document.getElementById('disqus_thread').classList.remove('hide')
    }

    if ('//哥特复兴.disqus.com/embed.js'.indexOf('duoshuo') > -1) {
        document.getElementById('duoshuo_thread').classList.remove('hide')
    }

}, false)

</script>

</body>
</html>
