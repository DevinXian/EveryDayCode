<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="google" content="notranslate" />
<link rel="icon" href="/assets/icon.png" />
<title>js 创建桌面快捷方式 10.08 - every day code </title>
<link rel="stylesheet" href="/assets/acyort.css" />
</head>
<body>

<div class="header">
    <div class="center">
        <h1><a href="/">every day code</a></h1>
        <p></p>
    </div>
    <div class="menu">
        <a href="/">home</a>
        <a href="/page/about/">about</a>
        <a href="/archives/">archives</a>
    </div>
</div>

<div id="post" class="center">

    <h1>js 创建桌面快捷方式 10.08</h1>
    <p><a href="https://github.com/dyygtfx">dyygtfx</a> Updated at Feb 11, 2015</p>

    <div class="content"><pre><code><span class="hljs-meta">&lt;!DOCTYPE HTML&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>桌面创建快捷方式<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"btn"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn"</span>
    <span class="hljs-attr">value</span>=<span class="hljs-string">"桌面创建快捷方式"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">"createDesktop('http://www.baidu.com/','百度')"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createDesktop</span>(<span class="hljs-params">sUrl, sName</span>) </span>{
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">var</span> fso = <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Scripting.FileSystemObject"</span>);
                <span class="hljs-keyword">var</span> shell = <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"WScript.Shell"</span>);
                  <span class="hljs-keyword">var</span> folderPath = shell.SpecialFolders(<span class="hljs-string">"Desktop"</span>);<span class="hljs-comment">//获取桌面本地桌面地址</span>
                  <span class="hljs-keyword">if</span> (!fso.FolderExists(folderPath)) {
                      fso.CreateFolder(folderPath);
                  }
                  <span class="hljs-keyword">if</span> (!fso.FileExists(folderPath + <span class="hljs-string">"//"</span> + sName + <span class="hljs-string">".lnk"</span>)) {
                <span class="hljs-comment">//在指定的文件夹下创建名为sName的快捷方式</span>
                      <span class="hljs-keyword">var</span> shortLink = shell.CreateShortcut(folderPath + <span class="hljs-string">"//"</span> + sName + <span class="hljs-string">".lnk"</span>); <span class="hljs-comment">//相应的描述信息</span>
                    shortLink.Description = <span class="hljs-string">"shortcut for "</span> + sName; <span class="hljs-comment">//快捷方式指向的链接</span>
                    shortLink.TargetPath = sUrl; <span class="hljs-comment">//激活链接并且窗口最大化</span>
                    shortLink.WindowStyle = <span class="hljs-number">3</span>;
                    shortLink.Save();
                    alert(<span class="hljs-string">'桌面快捷方式创建成功！'</span>);
                }
            } <span class="hljs-keyword">catch</span> (e) {
                doSave(<span class="hljs-string">"&lt;script&gt;location.href='"</span> + sUrl + <span class="hljs-string">"'&lt;/sc"</span> + <span class="hljs-string">"ript&gt;"</span>, <span class="hljs-string">"text/html"</span>, <span class="hljs-string">"百度.html"</span>);
            }
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doSave</span>(<span class="hljs-params">value, type, name</span>) </span>{
            <span class="hljs-keyword">var</span> blob;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.Blob == <span class="hljs-string">"function"</span>) {
                blob = <span class="hljs-keyword">new</span> Blob([value], {type: type});
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> BlobBuilder = <span class="hljs-built_in">window</span>.BlobBuilder || <span class="hljs-built_in">window</span>.MozBlobBuilder || <span class="hljs-built_in">window</span>.WebKitBlobBuilder || <span class="hljs-built_in">window</span>.MSBlobBuilder;
                <span class="hljs-keyword">var</span> bb = <span class="hljs-keyword">new</span> BlobBuilder();
                bb.append(value);
                blob = bb.getBlob(type);
            }
            <span class="hljs-keyword">var</span> URL = <span class="hljs-built_in">window</span>.URL || <span class="hljs-built_in">window</span>.webkitURL;
            <span class="hljs-keyword">var</span> bloburl = URL.createObjectURL(blob);
            <span class="hljs-keyword">var</span> anchor = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"a"</span>);
            <span class="hljs-keyword">if</span> (<span class="hljs-string">'download'</span> <span class="hljs-keyword">in</span> anchor) {
                anchor.style.visibility = <span class="hljs-string">"hidden"</span>;
                anchor.href = bloburl;
                anchor.download = name;
                <span class="hljs-built_in">document</span>.body.appendChild(anchor);
                <span class="hljs-keyword">var</span> evt = <span class="hljs-built_in">document</span>.createEvent(<span class="hljs-string">"MouseEvents"</span>);
                evt.initEvent(<span class="hljs-string">"click"</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>);
                anchor.dispatchEvent(evt);
                <span class="hljs-built_in">document</span>.body.removeChild(anchor);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (navigator.msSaveBlob) {
                navigator.msSaveBlob(blob, name);
            } <span class="hljs-keyword">else</span> {
                location.href = bloburl;
            }
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre></div>

    <div class="label">
    <div><a href="/tags/原生 JS/">#原生 JS</a></div>
    </div>

    <div class="comment_list hide" id="disqus_thread"></div>
    <div id="duoshuo_thread" class="comment_list hide ds-thread" data-thread-key="45212629" data-title="" data-url=""></div>

    <button class="hide" data-id="45212629" id="comment">Add Comments</button>

</div>

<div class="footer">
    <div class="center">
        © 2016 every day code . <a target="_blank" href="https://github.com/LoeiFy/AcyOrt">AcyOrt</a> . <a target="_blank" href="/rss.xml">RSS</a>
    </div>
</div>

<script>

if ('哥特复兴'.length > 0) {
    document.getElementById('comment').classList.remove('hide')
}

var duoshuoQuery = {short_name: '哥特复兴'};

document.getElementById('comment').addEventListener('click', function() {

    this.style.display = 'none';

    var identifier = this.getAttribute('data-id'),
        title = document.title,
        url = location.href.split('?')[0];

    document.getElementById('duoshuo_thread').setAttribute('data-title', title)
    document.getElementById('duoshuo_thread').setAttribute('data-url', url)

    var disqus_config = function () {
        this.page.url = url;
        this.page.identifier = identifier;
    };

    var sc = document.createElement('script'); 
    sc.async = true;
    sc.src = (location.protocol == 'https:' ? 'https:' : 'http:') + '//哥特复兴.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(sc);

    if ('//哥特复兴.disqus.com/embed.js'.indexOf('disqus') > -1) {
        document.getElementById('disqus_thread').classList.remove('hide')
    }

    if ('//哥特复兴.disqus.com/embed.js'.indexOf('duoshuo') > -1) {
        document.getElementById('duoshuo_thread').classList.remove('hide')
    }

}, false)

</script>

</body>
</html>
